import wikipediaapi
import os

def fetch_wikipedia_article(topic, save_path):
    try:
        wiki = wikipediaapi.Wikipedia(
            user_agent="StudyApp/1.0 (https://github.com/bijay91lt/Study-App)", 
            language='en'
        )
        page = wiki.page(topic)
        if not page.exists():
            print(f"❌ Error: '{topic}' not found on Wikipedia.")
            return
        
        os.makedirs(os.path.dirname(save_path), exist_ok=True)
        
        with open(save_path, "w", encoding="utf-8") as file:
            file.write(page.text)
        
        print(f"✅ Saved: {save_path}")
    except Exception as e:
        print(f"❌ Error: {e}")

def fetch_articles_from_category(category, num_articles=300):
    wiki = wikipediaapi.Wikipedia(
        user_agent="StudyApp/1.0 (https://github.com/bijay91lt/Study-App)", 
        language='en'
    )
    
    category_page = wiki.page(category)
    articles = category_page.categorymembers
    count = 0
    
    for topic in articles:
        if count >= num_articles:
            break
        fetch_wikipedia_article(topic, f"datasets/raw_texts/{topic.replace(' ', '_')}.txt")
        count += 1
    return count

# List of categories you want to fetch articles from
categories = [
    "Category:Branches_of_science",
    "Category:Scientific_disciplines",
    "Category:Scientists",
    "Category:Science_in_society",
    "Category:Science_and_technology",
    "Category:Scientific_terminology",
    "Category:Works_about_science",
    "Category:Science_books",
    "Category:Scientific_buildings",
    "Category:Scientific_classification",
    "Category:Scientific_comparisons",
    "Category:Empiricism",
    "Category:Scientific_exploration",
    "Category:Fringe_science",
    "Category:History_of_science",
    "Category:Scientific_instruments",
    "Category:Metascience",
    "Category:Scientific_method",
    "Category:Natural_history",
    "Category:Science_occupations",
    "Category:Open_science",
    "Category:Scientific_organizations",
    "Category:People_in_science",
    "Category:Scientific_phenomena",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Wikipedia_categories_named_after_science_projects",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Wikipedia_categories_named_after_science_projects",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Wikipedia_categories_named_after_science_projects",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Science_stubs",
    "Category:Wikipedia_categories_named_after_science_projects",
    "Category:Branches_of_science",
    "Category:Scientific_disciplines",
    "Category:Scientists",
    "Category:Science_in_society",
    "Category:Science_and_technology",
    "Category:Scientific_terminology",
    "Category:Works_about_science",
    "Category:Science_books",
    "Category:Scientific_buildings",
    "Category:Scientific_classification",
    "Category:Scientific_comparisons",
    "Category:Empiricism",
    "Category:Scientific_exploration",
    "Category:Fringe_science",
    "Category:History_of_science",
    "Category:Scientific_instruments",
    "Category:Metascience",
    "Category:History_of_science",
    "Category:Scientific_instruments",
    "Category:Metascience",
    "Category:Scientific_instruments",
    "Category:Metascience",
    "Category:Metascience",
    "Category:Scientific_method",
    "Category:Natural_history",
    "Category:Science_occupations",
    "Category:Open_science",
    "Category:Scientific_organizations",
    "Category:Open_science",
    "Category:Scientific_organizations",
    "Category:Scientific_organizations",
    "Category:People_in_science",
    "Category:Scientific_phenomena",
    "Category:Science_pioneers",
    "Category:Scientific_problems",
    "Category:Quotations_from_science",
    "Category:Scientific_speculation",
    "Category:Time_in_science",
    "Category:Women_and_science",
    "Category:Images_by_scientific_discipline",
    "Category:Science_stubs",
    "Category:Wikipedia_categories_named_after_science_projects",
    "Category:Technology_by_country",
    "Category:Technology_by_period",
    "Category:Technology_by_type",
    "Category:Science_and_technology",
    "Category:Outlines_of_technology_and_applied_science",
    "Category:Technology_in_society",
    "Category:People_associated_with_technology",
    "Category:People_in_technology",
    "Category:Works_about_technology",
    "Category:Artificial_objects",
    "Category:Inventions",
    "Category:Technological_change",
    "Category:Technical_communication",
    "Category:Technological_comparisons",
    "Category:Computing",
    "Category:Technological_controversies",
    "Category:Technology_development",
    "Category:Technology_evangelism",
    "Category:Glossaries_of_technology",
    "Category:History_of_technology",
    "Category:Hypothetical_technology",
    "Category:Kilns",
    "Category:Science_and_technology_ministries",
    "Category:Mobile_technology",
    "Category:Obsolete_technologies",
    "Category:Technology_organizations",
    "Category:Pejorative_terms_related_to_technology",
    "Category:Philosophy_of_technology",
    "Category:Sociology_of_technology",
    "Category:Technology_strategy",
    "Category:Technology_systems",
    "Category:Technical_specifications",
    "Category:Technological_management",
    "Category:Technology_assessment",
    "Category:Technology_education",
    "Category:Technology_hazards",
    "Category:Technology_stubs",
    "Category:History_by_location",
    "Category:History_by_period",
    "Category:Fields_of_history",
    "Category:Historiography",
    "Category:People_in_history_occupations",
    "Category:Chronology",
    "Category:Origins",
    "Category:Outlines_of_history_and_events",
    "Category:History_awards",
    "Category:Historical_controversies",
    "Category:History_in_culture",
    "Category:History_education",
    "Category:Glossaries_of_history",
    "Category:History_by_topic",
    "Category:Legacies",
    "Category:Historical_objects",
    "Category:History_organizations",
    "Category:Philosophy_of_history",
    "Category:Historic_preservation",
    "Category:Pseudohistory",
    "Category:Historical_works",
    "Category:History_images",
    "Category:History_stubs",
    "Category:Mathematics_by_country",
    "Category:Fields_of_mathematics",
    "Category:Mathematicians",
    "Category:Women_in_mathematics",
    "Category:Works_about_mathematics",
    "Category:Mathematics_and_art",
    "Category:Bruhat_family",
    "Category:Choquet_family",
    "Category:Mathematical_classification_systems",
    "Category:Mathematical_concepts",
    "Category:Mathematical_constants",
    "Category:Mathematics_and_culture",
    "Category:Eponyms_in_mathematics",
    "Category:Mathematical_examples",
    "Category:History_of_mathematics",
    "Category:Mathematics_occupations",
    "Category:Mathematical_notation",
    "Category:Outlines_of_mathematics_and_logic",
    "Category:Philosophy_of_mathematics",
    "Category:Mathematical_projects",
    "Category:Mathematical_proofs",
    "Category:Pseudomathematics",
    "Category:Set_index_articles_on_mathematics",
    "Category:Mathematical_terminology",
    "Category:Mathematical_theorems",
    "Category:Mathematical_tools",
    "Category:Mathematics_stubs",
    "Category:Physics_by_country",
    "Category:Subfields_of_physics",
    "Category:Modern_physics",
    "Category:Physicists",
    "Category:Eponyms_in_physics",
    "Category:Works_about_physics",
    "Category:Concepts_in_physics",
    "Category:Physical_modeling",
    "Category:Physics_in_society",
    "Category:Physics_stubs",
    "Category:Biology_by_city",
    "Category:Biology_by_country_subdivision",
    "Category:Biology_by_dependent_territory",
    "Category:Biology_by_continent",
    "Category:Biology_by_country",
    "Category:Branches_of_biology",
    "Category:Organisms",
    "Category:Biologists",
    "Category:Works_about_biology",
    "Category:Bioelectricity",
    "Category:Biomagnetics",
    "Category:Biological_censuses",
    "Category:Biological_classification",
    "Category:Biological_concepts",
    "Category:Biological_contamination",
    "Category:Biology_and_culture",
    "Category:Biological_descriptions",
    "Category:Biology_education",
    "Category:Eponyms_in_biology",
    "Category:Eukaryote_biology",
    "Category:Food_science",
    "Category:Geometry_in_biology",
    "Category:History_of_biology",
    "Category:Biology_images",
    "Category:Biological_interactions",
    "Category:Philosophy_of_biology",
    "Category:Biological_processes",
    "Category:Quantum_biology",
    "Category:Biological_records",
    "Category:Biological_rules",
    "Category:Biology_in_society",
    "Category:Specimens",
    "Category:Biological_systems",
    "Category:Biological_techniques_and_tools",
    "Category:Biology_terminology",
    "Category:Unsolved_problems_in_biology",
    "Category:Biological_waste",
    "Category:Biology_stubs",
]


total_articles = 0
max_articles = 300

# Loop through categories and fetch articles
for category in categories:
    if total_articles >= max_articles:
        break
    articles_fetched = fetch_articles_from_category(category, num_articles=max_articles - total_articles)
    total_articles += articles_fetched
    print(f"✅ Total articles fetched: {total_articles}")

print(f"✅ Finished fetching {total_articles} articles.")
